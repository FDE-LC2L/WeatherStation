<Button
    x:Class="WeatherStation.UserControls.ImageButton"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:WeatherStation.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:WeatherStation.UserControls"
    xmlns:localConverters="clr-namespace:WeatherStation.UserControls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Name="ImgButton"
    d:DesignHeight="450"
    d:DesignWidth="800"
    Style="{DynamicResource ResourceKey=ImgButtonStyle}"
    mc:Ignorable="d">


    <Button.Resources>

        <ResourceDictionary>
            <converters:BinaryImageConverter x:Key="binaryImageConverter" />
            <converters:ImageEnabledToOpacityConverter x:Key="imageEnabledToOpacityConverter" />

            <localConverters:VerticalOrientationToVisibilityConverter x:Key="verticalOrientationToVisibilityConverter" />
            <localConverters:HorizontalOrientationToVisibilityConverter x:Key="horizontalOrientationToVisibilityConverter" />


            <Style TargetType="Border">
                <Setter Property="CornerRadius" Value="{Binding ElementName=ImgButton, Path=CornerRadius}" />
            </Style>
            <Style
                x:Key="ImgButtonStyle"
                BasedOn="{StaticResource {x:Static ToolBar.ButtonStyleKey}}"
                TargetType="{x:Type Button}">
                <Setter Property="Background" Value="#00000000" />
                <Setter Property="BorderThickness" Value="0,0,0,0" />
                <Setter Property="Cursor" Value="Hand" />
                <Setter Property="Width" Value="120" />
            </Style>
        </ResourceDictionary>

    </Button.Resources>

    <Grid x:Name="GridMain">

        <Grid x:Name="GridVertical" Visibility="{Binding Orientation, ElementName=ImgButton, Converter={StaticResource verticalOrientationToVisibilityConverter}}">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="22" />
            </Grid.RowDefinitions>
            <Image
                x:Name="ButtonImageVertical"
                Grid.Row="0"
                Width="{Binding ElementName=ImgButton, Path=Width}"
                Opacity="{Binding ElementName=ImgButton, Path=IsEnabled, Converter={StaticResource imageEnabledToOpacityConverter}}"
                Source="{Binding ElementName=ImgButton, Path=ImageSrc}"
                Stretch="Uniform" />
            <Label
                x:Name="ButtonLabelVertical"
                Grid.Row="1"
                Padding="0"
                HorizontalContentAlignment="Center"
                VerticalContentAlignment="Center"
                Content="{Binding ElementName=ImgButton, Path=Text}"
                FlowDirection="LeftToRight"
                FontWeight="Bold" />
        </Grid>

        <Grid x:Name="GridHorizontal" Visibility="{Binding Orientation, ElementName=ImgButton, Converter={StaticResource horizontalOrientationToVisibilityConverter}}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Image
                x:Name="ButtonImageHorizontal"
                Grid.Column="0"
                Height="{Binding ElementName=ImgButton, Path=Height}"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                Opacity="{Binding ElementName=ImgButton, Path=IsEnabled, Converter={StaticResource imageEnabledToOpacityConverter}}"
                Source="{Binding ElementName=ImgButton, Path=ImageSrc}"
                Stretch="Uniform" />
            <Label
                x:Name="ButtonLabelHorizontal"
                Grid.Column="1"
                Margin="6,0,0,0"
                Padding="0"
                HorizontalContentAlignment="Center"
                VerticalContentAlignment="Center"
                Content="{Binding ElementName=ImgButton, Path=Text}"
                FlowDirection="LeftToRight"
                FontWeight="Bold" />
        </Grid>

    </Grid>
</Button>
